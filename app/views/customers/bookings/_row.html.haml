- event = booking.event
- trip = booking.trip

%tr[booking]
  %td{:style => 'width: 150px'}
    = icon :calendar, '', class: 'fa-fw text-muted'
    = link_to [:edit, event] do
      = l event.start_time, format: :short

  %td
    - trip = booking.trip
    - if trip.present?
      - if trip.code.present?
        .label.label-default{ :style => 'background-color: %s;' % trip.color }<
          = trip.code
      = trip.name

  %td
    - unless event.guided_dive?
      %small.text-muted<
        %i.fa.fa-star-o
        non-guided dive

  %td
    - if event.guided_dive?
      %small.text-muted<
        %i.fa.fa-star
        guided dive

  %td
    - if event.boat_dive?
      %small.text-muted<
        %i.fa.fa-anchor
        boat dive

  %td
    - if event.night_dive?
      %small.text-muted<
        %i.fa.fa-moon-o
        night dive

  %td.text-right
    - if booking.price.present?
      .btn-group
        %button.btn.btn-default.btn-xs.dropdown-toggle{type: 'button', data: { toggle: 'dropdown' }}
          = icon :money
          - if booking.price > 0
            = '%0.2f' % booking.price
          - else
            free
          %span.caret

        %ul.dropdown-menu{role: 'menu'}
          %li
            = link_to customer_booking_path(customer, booking, booking: { price: 0 }), method: :patch do
              %small
                = icon :times, 'Mark as free', class: 'fa-fw'
                .text-muted
                  = icon :money, '0.00', class: 'fa-fw'
          %li
            = link_to customer_booking_path(customer, booking, booking: { price: '' }), method: :patch do
              %small
                = icon :calendar, 'Use event price', class: 'fa-fw'
                .text-muted
                  = icon :money, '', class: 'fa-fw'
                  - if booking.event_price.present?
                    = booking.event_price
                  - else
                    No price

  %td.actions-column
    = action_links_for [customer, booking], :edit, :delete
